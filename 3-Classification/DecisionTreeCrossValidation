from sklearn.model_selection import cross_val_score
from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
from sklearn import tree
import pandas as pd 
import matplotlib.pyplot as plt

def main():

    input_file = '0-Datasets/WineQTClear.data'
    names = ['fixed acidity','volatile acidity','citric acid','residual sugar','chlorides','free sulfur dioxide','total sulfur dioxide','density','pH','sulphates','alcohol','quality']
    
    df = pd.read_csv(input_file, names = names)

    X = df.drop('quality', axis=1)
    y = df['quality']

    clf = DecisionTreeClassifier(max_leaf_nodes=5)
    scores = cross_val_score(clf, X, y, cv=6)

    print("Accuracy scores for each fold:", scores)
    print("Mean accuracy:", scores.mean())

    clf.fit(X, y)
    tree.plot_tree(clf)
    plt.show()

if __name__ == "__main__":
    main()
